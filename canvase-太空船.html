<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>太空船</title>
		<style>*{margin:0;padding:0;}</style>
	</head>
	<body>
		<canvas id="canvas" height="500" width="500" style="background:#0090d3">
			your browser not support canvas!
		</canvas>
		<script type="text/javascript" src="js/canvas-utils.js" ></script>
		<script type="text/javascript" src="js/spaceShip.js" ></script>
		<script>
			+function(){
				var canvas=document.querySelector("#canvas"),
					context=canvas.getContext("2d");
					
				var spaceShip=new SpaceShip()
				spaceShip.x=canvas.width/2;
				spaceShip.y=canvas.height/2;
				
				//初始化
				var vr=0,vx=0,vy=0,ax=0,ay=0,
					angle=0,thrust=0;
				
				window.addEventListener("keydown",function(event){
					switch(event.keyCode){
						case 37:	//left
							vr=-3;
							vx=0;
							vy=0;
							break;
						case 39:	//right
							vr=3;
							vx=0;
							vy=0;
							break;
						case 38:	//up
							spaceShip.showFlame=true;
							thrust=.05;
							break;
						case 40:	//down	
							ax=0;
							ay=0;
							vx=0;
							vy=0;
							break;
					}
				},false);
				
				window.addEventListener("keyup",function(event){
					vr=0;
					thrust=0;
					spaceShip.showFlame=false;
				},false);
				
				(function(){
					requestAnimationFrame(arguments.callee,canvas);
					context.clearRect(0,0,canvas.width,canvas.height);
					
					//角度
					spaceShip.rotation+=vr*Math.PI/180;
					
					angle=spaceShip.rotation;
					ax=Math.cos(angle)*thrust;
					ay=Math.sin(angle)*thrust;
					
					vx+=ax;
					vy+=ay;
					
					spaceShip.x+=vx;
					spaceShip.y+=vy;
					
					spaceShip.draw(context);
					
				})();
				
				spaceShip.draw(context);
				
			}();
		</script>
	</body>
</html>
